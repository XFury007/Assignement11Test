<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodel="clr-namespace:MauiBankingExercise.ViewModel"
             x:Class="MauiBankingExercise.Views.AccountsPage">

    <ContentPage.BindingContext>
        <viewmodel:AccountsViewModel />
    </ContentPage.BindingContext>

    <VerticalStackLayout Padding="20" Spacing="10">

        <Button Text="Reload Accounts" 
                Clicked="OnLoadAccountsClicked" />

        <!-- Loading indicator -->
        <ActivityIndicator IsRunning="{Binding IsLoading}" 
                           IsVisible="{Binding IsLoading}" 
                           Color="Blue" />

        <!-- Error message -->
        <Label Text="{Binding ErrorMessage}" 
               TextColor="Red"
               IsVisible="{Binding ErrorMessage, Converter={StaticResource StringNotNullOrEmptyConverter}}" />

        <!-- Accounts list -->
        <CollectionView ItemsSource="{Binding Accounts}"
                        SelectionMode="None">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <VerticalStackLayout Padding="10" Margin="0,5" BackgroundColor="#f5f5f5">
                        <Label Text="{Binding AccountNumber}" FontAttributes="Bold"/>
                        <Label Text="{Binding AccountBalance, StringFormat='Balance: {0:C}'}"/>
                        <Label Text="{Binding Customer.FirstName}" />
                    </VerticalStackLayout>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

    </VerticalStackLayout>
</ContentPage>
